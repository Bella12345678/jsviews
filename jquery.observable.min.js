/*
 * jQuery Observable Plugin v1.0pre
 * Observable changes on arrays and objects
 * http://github.com/BorisMoore/jsviews
 */
(function(a,f){a.observable=function(b){return a.isArray(b)?new ObservableArray(b):new ObservableObject(b)};a.observer=function(c){var b=a.observable(c);b.changes=[],b.observe=function(){this.changes.length&&a([this._data]).triggerHandler("arrayChange",this.changes);this.changes=[]}};var b=a.observable.extend=jQuery.extend;ObservableArray=function(a){this._data=a;return this};a.observable.array=ObservableArray.prototype={constructor:a.observable,data:function(){return this._data},extend:b};ObservableObject=function(a){this._data=a;return this};a.observable.object=ObservableObject.prototype={constructor:a.observable,data:function(){return this._data},extend:b};var d={pop:function(){var a=this.length;if(a)return{action:"remove",oldIndex:a-1,oldItems:[this[a-1]]}},push:function(){return{action:"add",newIndex:this.length,newItems:[arguments[0]]}},reverse:function(){if(this.length)return{action:"reset"}},shift:function(){if(this.length)return{action:"remove",oldIndex:0,oldItems:[this[0]]}},sort:function(){if(this.length)return{action:"reset"}},splice:function(){var e=a.makeArray(arguments),b=e[0],f=e[1],d,c=e.slice(2);if(f<=0){if(c.length)return{action:"add",newIndex:b,newItems:c}}else{d=this.slice(b,b+f);return c.length?{action:"move",oldIndex:b,oldItems:d,newIndex:b,newItems:c}:{action:"remove",oldIndex:b,oldItems:d}}},unshift:function(){return{action:"add",newIndex:0,newItems:[arguments[0]]}},move:function(){var a,b=arguments[1];if(b>0){a=arguments[0];return{action:"move",oldIndex:a,oldItems:this.splice(a,b),newIndex:arguments[2]}}}};function e(c,b,d){if(b){switch(b.action){case"add":[].splice.apply(c,[].concat(b.newIndex,0,b.newItems));break;case"remove":c.splice(b.oldIndex,b.oldItems.length);break;case"move":c.splice(b.oldIndex,b.oldItems.length);[].splice.apply(c,[].concat(b.newIndex,0,b.newItems))}if(d)d.push(b);else a([c]).triggerHandler("arrayChange",b)}}a.each(["pop","push","reverse","shift","unshift","sort","splice","move"],function(c,b){a.observable.array[b]=function(){var a=this._data;e(a,d[b].apply(a,arguments),this.changes);return this}});a.observable.array.extend({replace:function(a){this.splice.apply(this,[].concat(0,this._data.length,a));return this}});a.observable.object.extend({setField:function(b,e){if(e===f)if(typeof b==="object"){for(var i in b)this.setField(i,b[i]);return this}var g=this._data,h=[{action:"setField",path:b,value:e}],d=c(g,b);b=d[1];d=d[0];if(d&&d[b]!==e){d[b]=e;if(this.changes)this.changes.push(h);else a(g).triggerHandler("objectChange",h)}return this}});function c(a,b){if(a&&b){var c=b.split(".");b=c.pop();while(a&&c.length)a=a[c.shift()];return[a,b]}return[]}})(jQuery);